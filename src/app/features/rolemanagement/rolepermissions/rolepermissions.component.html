<!--Sticky Header-->
<div class="header sticky">
    <div class="title-section">
        <!-- Page Icon -->
        <div class="page-icon">
            <mat-icon class="icon-large">shield</mat-icon>
        </div>
        <div class="title-content">        
            <h2>Roles Permission</h2>
            <nav class="breadcrumbs">
                <a href="#" class="breadcrumb-item">E-Commerce</a>
                <span class="breadcrumb-separator">•</span>
                <a href="#" class="breadcrumb-item">Products</a>
                <span class="breadcrumb-separator">•</span>
                <span class="breadcrumb-item active">List</span>
            </nav>
        </div>       
        <div class="header-actions">
            <button mat-stroked-button [matMenuTriggerFor]="menu">
                More
            <mat-icon>expand_more</mat-icon>
            </button>
            <mat-menu #menu="matMenu">
            <button mat-menu-item>
                <mat-icon>file_download</mat-icon>
                Export
            </button>
            <button mat-menu-item>
                <mat-icon>print</mat-icon>
                Print
            </button>
            </mat-menu>
            <button mat-flat-button color="primary" class="add-button">
            <mat-icon>add</mat-icon>
                Add Permission
            </button>            
        </div>
    </div>
</div>
<!-- Content Section -->
<div class="pageWrapper">
    <mat-form-field class="select-md" appearance="outline">
        <mat-label>Select Role</mat-label>
        <mat-select>
            <mat-option value="admin">Admin</mat-option>
            <mat-option value="cashier">Cashier</mat-option>
            <mat-option value="manager">Manager</mat-option>
        </mat-select>
    </mat-form-field>
    <div class="row">
        <div class="col-lg-4">            
            <mat-card class="permissions-card">
                <!-- Header Section -->
                <div class="header-section">
                    <div class="header-content">
                    <div class="header-info">
                        <div class="icon-container">
                        <mat-icon class="header-icon">security</mat-icon>
                        </div>
                        <div class="header-text">
                        <h2 class="title">Menu Permissions</h2>
                        <p class="subtitle">{{ selectedCount() }} of {{ permissions().length }} selected</p>
                        </div>
                    </div>
                    <!-- Move Select All Section to header right -->
                    <div class="select-all-section header-select-all">
                        <mat-checkbox
                        [checked]="allSelected()"
                        [indeterminate]="someSelected() && !allSelected()"
                        (change)="toggleSelectAll()"
                        color="primary"
                        class="select-all-checkbox"
                        >
                        <span class="select-all-label">Select All</span>
                        </mat-checkbox>
                    </div>
                    <button 
                        mat-icon-button 
                        class="expand-button"
                        (click)="toggleExpanded()"
                        [class.expanded]="isExpanded()"
                        matTooltip="{{ isExpanded() ? 'Collapse' : 'Expand' }}"
                    >
                        <mat-icon>expand_more</mat-icon>
                    </button>
                    </div>
                    
                    <!-- Progress Bar -->
                    <mat-progress-bar 
                    mode="determinate" 
                    [value]="progressValue()"
                    class="progress-bar"
                    ></mat-progress-bar>
                </div>

                <!-- Content Section -->
                <div class="content-section" [class.expanded]="isExpanded()">
                    <mat-card-content class="card-content compact-content">                   

                    <!-- Permissions List -->
                    <div class="permissions-list two-columns">
                        @for (permission of permissions(); track permission.key) {
                        <div 
                            class="permission-item"
                            [class.selected]="permission.selected"
                            (click)="togglePermission(permission.key)"
                        >
                            <mat-checkbox
                            [checked]="permission.selected"
                            color="primary"
                            class="permission-checkbox"
                            (click)="$event.stopPropagation()"
                            (change)="togglePermission(permission.key)"
                            >
                            </mat-checkbox>
                            <div class="permission-icon-container" [class.selected]="permission.selected">
                                <mat-icon class="permission-icon">{{ permission.icon }}</mat-icon>
                            </div>
                        
                            <div class="permission-details">
                                <div class="permission-header">
                                    <h4 class="permission-title">{{ permission.label }}</h4>
                                    @if (permission.selected) {                                   
                                    }
                                </div>
                            </div>                          
                        </div>
                        }
                    </div>
                    </mat-card-content>
                </div>
                </mat-card>

        </div>
        <div class="col-lg-6">
            <mat-card class="cardWithShadow">      
                <mat-card-content>
                    <div class="m-r-auto">
                        <mat-card-title>Menu</mat-card-title>
                        <mat-card-subtitle>Permissions</mat-card-subtitle>
                    </div>                 
                </mat-card-content>
            </mat-card>
        </div>
    </div>
    
</div>
